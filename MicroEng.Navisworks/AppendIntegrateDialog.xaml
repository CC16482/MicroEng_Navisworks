<Window x:Class="MicroEng.Navisworks.AppendIntegrateDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:local="clr-namespace:MicroEng.Navisworks"
        xmlns:system="clr-namespace:System;assembly=System"
        Title="MicroEng - Data Mapper"
        Height="640" Width="900"
        Background="{DynamicResource ApplicationBackgroundBrush}"
        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
        FontSize="12"
        WindowStartupLocation="CenterOwner">
  <Window.Resources>
    <ResourceDictionary>
      <system:Double x:Key="ControlContentThemeFontSize">12</system:Double>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="{x:Static local:MicroEngResourceUris.WpfUiRoot}" />
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
  </Window.Resources>

  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <!-- Use ui:Card for layout containers (CardControl offsets Content to the right by design). -->
    <ui:Card Grid.Row="0"
             Padding="10"
             Margin="0,0,0,8"
             HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch"
             VerticalContentAlignment="Top">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto" />
          <RowDefinition Height="Auto" />
          <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Vertical">
          <ui:TextBlock Text="Data Mapper" FontSize="16" FontWeight="SemiBold" />
          <ui:TextBlock Text="Apply templates and mapped properties using Data Scraper cache."
                        Margin="0,4,0,0"
                        FontSize="12"
                        Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
        </StackPanel>

        <ui:Button Grid.Row="0"
                   Grid.Column="1"
                   Content="Close"
                   Appearance="Primary"
                   Padding="12,6"
                   Click="Close_Click" />

        <Grid Grid.Row="1" Grid.ColumnSpan="2" Margin="0,8,0,0">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="220" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
          </Grid.ColumnDefinitions>
          <TextBlock VerticalAlignment="Center" Text="Template:" Margin="0,0,6,0" />
          <ComboBox x:Name="TemplateCombo" Grid.Column="1" Width="220" SelectionChanged="TemplateCombo_SelectionChanged"
                    />
          <ui:Button Grid.Column="2" Content="New" Margin="6,0,0,0" Click="NewTemplate_Click" />
          <ui:Button Grid.Column="3" Content="Copy" Margin="6,0,0,0" Click="CopyTemplate_Click" />
          <ui:Button Grid.Column="4" Content="Rename" Margin="6,0,0,0" Click="RenameTemplate_Click" />
          <ui:Button Grid.Column="5" Content="Delete" Margin="6,0,0,0" Click="DeleteTemplate_Click" />
          <ui:Button Grid.Column="6" Content="Save" Appearance="Primary" Margin="6,0,0,0" Click="SaveTemplate_Click" />
        </Grid>

        <StackPanel Grid.Row="2" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,8,0,0">
          <TextBlock Text="Data Scraper Profile:" VerticalAlignment="Center" Margin="0,0,6,0" />
          <ComboBox x:Name="DataProfileCombo" Width="220" SelectionChanged="DataProfileCombo_SelectionChanged"
                    IsEditable="False" />
        </StackPanel>
      </Grid>
    </ui:Card>

    <!-- Tabs -->
    <ui:Card Grid.Row="2"
             Padding="10"
             Margin="0,0,0,8"
             HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch"
             VerticalAlignment="Stretch"
             VerticalContentAlignment="Stretch">
    <TabControl Background="Transparent"
                Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                FontSize="12"
                HorizontalContentAlignment="Stretch"
                VerticalContentAlignment="Stretch">
      <TabItem Header="Standard">
        <Grid Margin="8">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
          </Grid.RowDefinitions>

          <StackPanel Orientation="Horizontal" Grid.Row="0" Margin="0,0,0,8">
            <TextBlock Text="Target Tab Name:" VerticalAlignment="Center" Margin="0,0,6,0" />
            <TextBox x:Name="TargetTabTextBox" Width="220" Padding="10,6" VerticalContentAlignment="Center" />
          </StackPanel>

          <ui:DataGrid x:Name="RowsGrid"
                     Grid.Row="1"
                     AutoGenerateColumns="False"
                     CanUserAddRows="False"
                     CanUserDeleteRows="False"
                     ItemsSource="{Binding Rows}"
                     GridLinesVisibility="All"
                     HorizontalGridLinesBrush="{DynamicResource MicroEngDataGridGridLineBrush}"
                     VerticalGridLinesBrush="{DynamicResource MicroEngDataGridGridLineBrush}"
                     FontSize="12"
                     RowHeight="28"
                     ColumnHeaderHeight="30"
                     HeadersVisibility="Column">
            <ui:DataGrid.Columns>
              <DataGridTextColumn Header="Target Property Name" Binding="{Binding TargetPropertyName}" Width="160" />
              <DataGridComboBoxColumn x:Name="ModeColumn"
                                      Header="Mode"
                                      SelectedItemBinding="{Binding Mode}"
                                      Width="110" />
              <DataGridTextColumn Header="Source Property" Binding="{Binding SourcePropertyLabel}" IsReadOnly="True" Width="170" />
              <DataGridTemplateColumn Header="" Width="40">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <ui:Button Content="..." Width="24" Height="22" Click="PickSource_Click" />
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>
              <DataGridTextColumn Header="Static / Expression Value" Binding="{Binding StaticOrExpressionValue}" Width="160" />
              <DataGridComboBoxColumn x:Name="OptionColumn"
                                      Header="Option"
                                      SelectedItemBinding="{Binding Option}"
                                      Width="150" />
              <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" Width="60" />
            </ui:DataGrid.Columns>
          </ui:DataGrid>

          <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,8,0,0">
            <ui:Button Content="Add Row" Click="AddRow_Click" />
            <ui:Button Content="Delete Row" Margin="6,0,0,0" Click="DeleteRow_Click" />
          </StackPanel>
        </Grid>
      </TabItem>

      <TabItem Header="Advanced">
        <Grid Margin="12">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
          </Grid.RowDefinitions>

          <GroupBox Header="Apply Property To" Grid.Column="0" Margin="0,0,8,8">
            <StackPanel>
              <RadioButton x:Name="ApplyItemsRadio" Content="Items" />
              <RadioButton x:Name="ApplyGroupsRadio" Content="Groups" />
              <RadioButton x:Name="ApplyBothRadio" Content="Items &amp; Groups" />
            </StackPanel>
          </GroupBox>

          <GroupBox Header="Tab Creation / Update" Grid.Column="1" Margin="0,0,0,8">
            <StackPanel>
              <CheckBox x:Name="CreateTabCheck" Content="Create Target Tab if Not Existing" />
              <CheckBox x:Name="KeepTabsCheck" Content="Keep Existing Tabs" />
              <CheckBox x:Name="UpdateTabCheck" Content="Update Existing Target Tab" />
              <CheckBox x:Name="DeleteBlankCheck" Content="Delete Property If Value Is Blank" />
              <CheckBox x:Name="DeleteTabBlankCheck" Content="Delete Target Tab If All Values Blank" />
            </StackPanel>
          </GroupBox>

          <GroupBox Header="Scope" Grid.Row="1" Grid.Column="0" Margin="0,0,8,0">
            <StackPanel>
              <CheckBox x:Name="ApplySelectionCheck" Content="Apply to Selection Only" />
              <CheckBox x:Name="ShowInternalNamesCheck" Content="Show internal property names" />
            </StackPanel>
          </GroupBox>
        </Grid>
      </TabItem>
    </TabControl>
    </ui:Card>

    <!-- Bottom bar -->
    <ui:Card Grid.Row="3"
             Padding="10"
             HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch"
             VerticalContentAlignment="Center">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <TextBlock x:Name="StatusText" Text="Ready" VerticalAlignment="Center" Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
        <ui:Button Grid.Column="1" Content="Run" Appearance="Primary" Margin="6,0,0,0" Click="Run_Click" />
      </Grid>
    </ui:Card>
  </Grid>
</Window>
