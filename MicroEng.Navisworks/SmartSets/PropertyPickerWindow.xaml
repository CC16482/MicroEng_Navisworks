<Window x:Class="MicroEng.Navisworks.SmartSets.PropertyPickerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        Title="Pick Property"
        Width="920" Height="620"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="{DynamicResource ApplicationBackgroundBrush}"
        Foreground="{DynamicResource TextFillColorPrimaryBrush}">
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ui:TextBox Grid.Row="0"
                    Margin="0,0,0,10"
                    PlaceholderText="Search category or property..."
                    Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" />

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="240" />
                <ColumnDefinition Width="12" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ui:Card Grid.Column="0" Padding="10">
                <DockPanel>
                    <ui:TextBlock DockPanel.Dock="Top" Text="Categories" FontWeight="SemiBold" Margin="0,0,0,8" />
                    <ListBox ItemsSource="{Binding Categories}"
                             SelectedItem="{Binding SelectedCategory}"
                             MinHeight="300" />
                </DockPanel>
            </ui:Card>

            <ui:Card Grid.Column="2" Padding="10">
                <DockPanel>
                    <ui:TextBlock DockPanel.Dock="Top" Text="Properties" FontWeight="SemiBold" Margin="0,0,0,8" />
                    <ui:DataGrid ItemsSource="{Binding FilteredProperties}"
                                 SelectedItem="{Binding SelectedProperty}"
                                 AutoGenerateColumns="False"
                                 CanUserReorderColumns="True"
                                 CanUserSortColumns="True"
                                 CanUserAddRows="False"
                                 IsReadOnly="True"
                                 SelectionMode="Single"
                                 MouseDoubleClick="DataGrid_MouseDoubleClick">
                        <ui:DataGrid.Columns>
                            <DataGridTextColumn Header="Category" Binding="{Binding Category}" Width="2*" />
                            <DataGridTextColumn Header="Property" Binding="{Binding Name}" Width="3*" />
                            <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="120" />
                            <DataGridTextColumn Header="Items" Binding="{Binding ItemCount}" Width="90" />
                            <DataGridTextColumn Header="Distinct" Binding="{Binding DistinctCount}" Width="90" />
                            <DataGridTextColumn Header="Samples" Binding="{Binding SampleValuesPreview}" Width="4*" />
                        </ui:DataGrid.Columns>
                    </ui:DataGrid>
                </DockPanel>
            </ui:Card>
        </Grid>

        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,10,0,0">
            <ui:Button Content="Cancel" Click="Cancel_Click" Margin="0,0,8,0" />
            <ui:Button Content="Use Selected"
                       Appearance="Primary"
                       Click="Ok_Click"
                       IsEnabled="{Binding CanAccept}" />
        </StackPanel>
    </Grid>
</Window>
