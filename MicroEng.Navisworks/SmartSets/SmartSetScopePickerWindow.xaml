<Window x:Class="MicroEng.Navisworks.SmartSets.SmartSetScopePickerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:system="clr-namespace:System;assembly=System"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        xmlns:local="clr-namespace:MicroEng.Navisworks"
        xmlns:smartsets="clr-namespace:MicroEng.Navisworks.SmartSets"
        Title="Scope Picker"
        Width="760"
        Height="620"
        MinWidth="640"
        MinHeight="520"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="{DynamicResource ApplicationBackgroundBrush}"
        Foreground="{DynamicResource TextFillColorPrimaryBrush}"
        FontSize="12">
    <Window.Resources>
        <ResourceDictionary>
            <system:Double x:Key="ControlContentThemeFontSize">12</system:Double>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="{x:Static local:MicroEngResourceUris.WpfUiRoot}" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>
    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Grid Grid.Row="0" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="220" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <TextBlock Text="Search in:" VerticalAlignment="Center" Margin="0,0,6,0" />
            <ComboBox Grid.Column="1"
                      ItemsSource="{Binding SearchInModeOptions}"
                      DisplayMemberPath="Label"
                      SelectedValuePath="Value"
                      SelectedValue="{Binding SelectedSearchInMode}" />
            <TextBlock Grid.Column="2"
                       Margin="12,0,0,0"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                       Text="{Binding StatusText}" />
        </Grid>

        <Grid Grid.Row="1">
            <Grid>
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsTreeMode}" Value="True">
                                <Setter Property="Visibility" Value="Visible" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>

                <ui:Card Padding="10">
                    <DockPanel>
                        <ui:TextBlock DockPanel.Dock="Top" Text="Model tree" FontWeight="SemiBold" Margin="0,0,0,8" />
                        <TreeView ItemsSource="{Binding RootNodes}"
                                  Foreground="{DynamicResource TextFillColorPrimaryBrush}">
                            <TreeView.ItemContainerStyle>
                                <Style TargetType="TreeViewItem"
                                       BasedOn="{StaticResource {x:Type TreeViewItem}}">
                                    <Setter Property="IsExpanded" Value="{Binding IsExpanded, Mode=TwoWay}" />
                                </Style>
                            </TreeView.ItemContainerStyle>
                            <TreeView.Resources>
                                <HierarchicalDataTemplate DataType="{x:Type smartsets:SmartSetScopeTreeNode}" ItemsSource="{Binding Children}">
                                    <CheckBox IsChecked="{Binding IsChecked, Mode=TwoWay}"
                                              IsThreeState="True"
                                              Content="{Binding DisplayName}"
                                              VerticalAlignment="Center" />
                                </HierarchicalDataTemplate>
                            </TreeView.Resources>
                        </TreeView>
                    </DockPanel>
                </ui:Card>
            </Grid>

            <Grid>
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Setter Property="Visibility" Value="Collapsed" />
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsPropertyFilterMode}" Value="True">
                                <Setter Property="Visibility" Value="Visible" />
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>

                <ui:Card Padding="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Category:" Margin="0,0,6,6" VerticalAlignment="Center" />
                        <ComboBox Grid.Row="0" Grid.Column="1"
                                  ItemsSource="{Binding Categories}"
                                  SelectedItem="{Binding SelectedCategory}"
                                  IsEnabled="{Binding IsPropertyFilterAvailable}" />

                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Property:" Margin="0,0,6,6" VerticalAlignment="Center" />
                        <ComboBox Grid.Row="1" Grid.Column="1"
                                  ItemsSource="{Binding Properties}"
                                  SelectedItem="{Binding SelectedProperty}"
                                  IsEnabled="{Binding IsPropertyFilterAvailable}" />

                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Value:" Margin="0,0,6,6" VerticalAlignment="Center" />
                        <ComboBox Grid.Row="2" Grid.Column="1"
                                  ItemsSource="{Binding Values}"
                                  IsEditable="True"
                                  Text="{Binding SelectedValue, UpdateSourceTrigger=PropertyChanged}"
                                  IsEnabled="{Binding IsPropertyFilterAvailable}" />

                        <TextBlock Grid.Row="3"
                                   Grid.ColumnSpan="2"
                                   Margin="0,8,0,0"
                                   Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                   Text="{Binding PropertyFilterStatusText}">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed" />
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsPropertyFilterAvailable}" Value="False">
                                            <Setter Property="Visibility" Value="Visible" />
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Grid>
                </ui:Card>
            </Grid>
        </Grid>

        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,10,0,0">
            <ui:Button Content="Cancel" Click="Cancel_Click" Margin="0,0,8,0" />
            <ui:Button Content="Use Scope"
                       Appearance="Primary" Foreground="{DynamicResource TextFillColorInverseBrush}" FontWeight="Bold"
                       Click="Ok_Click"
                       IsEnabled="{Binding CanAccept}" />
        </StackPanel>
    </Grid>
</Window>
