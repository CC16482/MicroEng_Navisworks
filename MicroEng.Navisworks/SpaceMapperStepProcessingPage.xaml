<Page x:Class="MicroEng.Navisworks.SpaceMapperStepProcessingPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:local="clr-namespace:MicroEng.Navisworks"
      xmlns:system="clr-namespace:System;assembly=System"
      mc:Ignorable="d"
      d:DesignHeight="600"
      d:DesignWidth="900"
      Background="Transparent"
      Foreground="{DynamicResource TextFillColorPrimaryBrush}"
      ScrollViewer.VerticalScrollBarVisibility="Disabled"
      ScrollViewer.HorizontalScrollBarVisibility="Disabled"
      FontSize="12">

  <Page.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="{x:Static local:MicroEngResourceUris.WpfUiRoot}" />
      </ResourceDictionary.MergedDictionaries>
      <system:Double x:Key="ControlContentThemeFontSize">12</system:Double>
      <Style x:Key="HelpFlyoutButtonStyle" TargetType="Button">
        <Setter Property="Width" Value="18" />
        <Setter Property="Height" Value="18" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Margin" Value="1,0,0,0" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="IsTabStop" Value="False" />
        <Setter Property="Focusable" Value="False" />
        <Setter Property="Cursor" Value="Hand" />
        <Setter Property="Foreground" Value="{DynamicResource TextFillColorSecondaryBrush}" />
        <Setter Property="Template">
          <Setter.Value>
            <ControlTemplate TargetType="Button">
              <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
            </ControlTemplate>
          </Setter.Value>
        </Setter>
      </Style>
    </ResourceDictionary>
  </Page.Resources>

  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <ui:Card Grid.Row="0"
             Padding="10"
             Margin="0,0,0,8"
             HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch">
      <StackPanel>
        <ui:TextBlock Text="Step 3 - Processing" FontSize="16" FontWeight="SemiBold" />
        <ui:TextBlock Text="Configure how intersections are evaluated and how offsets are applied."
                      Margin="0,4,0,0"
                      FontSize="12"
                      Foreground="{DynamicResource TextFillColorSecondaryBrush}" />
      </StackPanel>
    </ui:Card>

    <ui:Card Grid.Row="1"
             Padding="10"
             Margin="0,0,0,8"
             HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch"
             VerticalContentAlignment="Top"
             VerticalAlignment="Top">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto" />
          <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <ui:TextBlock Grid.Row="0"
                      Grid.ColumnSpan="2"
                      Text="Processing Mode"
                      FontSize="14"
                      FontWeight="SemiBold" />

        <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,6,16,0">
          <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
            <TextBlock Text="Preset" VerticalAlignment="Center" />
            <Button x:Name="PresetHelpFlyoutButton"
                    Style="{StaticResource HelpFlyoutButtonStyle}">
              <ui:SymbolIcon Symbol="Info16" />
            </Button>
          </StackPanel>

          <ui:Flyout x:Name="PresetHelpFlyout" Placement="Top">
            <StackPanel x:Name="PresetHelpFlyoutContent" Width="420">
              <TextBlock Text="Performance Presets" FontWeight="SemiBold" Margin="0,0,0,4" />
              <TextBlock TextWrapping="Wrap">
                Auto chooses Fast/Normal/Accurate based on preflight density.
                Fast uses AABB-only classification, Normal uses corner sampling, Accurate uses extra sampling points.
              </TextBlock>
            </StackPanel>
          </ui:Flyout>

          <CheckBox x:Name="AutoPresetToggleControl"
                    Content="Auto (Recommended)"
                    Margin="0,6,0,0"
                    IsChecked="True" />

          <Slider x:Name="PresetSliderControl"
                  Minimum="0"
                  Maximum="2"
                  TickFrequency="1"
                  IsSnapToTickEnabled="True"
                  TickPlacement="Both"
                  Value="1"
                  IsEnabled="False"
                  Margin="0,6,0,0" />

          <UniformGrid Columns="3" Margin="0,4,0,0">
            <TextBlock Text="Fast" HorizontalAlignment="Center" />
            <TextBlock Text="Normal" HorizontalAlignment="Center" />
            <TextBlock Text="Accurate" HorizontalAlignment="Center" />
          </UniformGrid>

          <TextBlock x:Name="PresetDescriptionTextControl"
                     Margin="0,6,0,0"
                     TextWrapping="Wrap"
                     Foreground="{DynamicResource TextFillColorSecondaryBrush}" />

          <TextBlock x:Name="PresetResolvedTextControl"
                     Margin="0,2,0,0"
                     TextWrapping="Wrap"
                     Foreground="{DynamicResource TextFillColorTertiaryBrush}" />
        </StackPanel>

        <StackPanel Grid.Row="1" Grid.Column="1" Margin="0,6,0,0">
          <TextBlock Text="Behavior" FontWeight="SemiBold" Margin="0,0,0,6" />
          <CheckBox x:Name="TreatPartialCheckControl" Content="Treat Partial as Contained" Margin="0,0,0,6" />
          <CheckBox x:Name="TagPartialCheckControl" Content="Write Zone Behaviour property" Margin="0,0,0,6" />
          <StackPanel Margin="16,0,0,6">
            <TextBlock Text="Writes Contained/Partial status to a separate property."
                       FontSize="11"
                       Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                       Margin="0,0,0,6" />
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
              </Grid.RowDefinitions>

              <TextBlock Text="Behaviour Category:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,6,6" />
              <TextBox x:Name="ZoneBehaviorCategoryBoxControl" Grid.Row="0" Grid.Column="1" MinWidth="160" Margin="0,0,0,6" Text="ME_SpaceInfo" />

              <TextBlock Text="Behaviour Property:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,6,6" />
              <TextBox x:Name="ZoneBehaviorPropertyBoxControl" Grid.Row="1" Grid.Column="1" MinWidth="160" Margin="0,0,0,6" Text="Zone Behaviour" />

              <TextBlock Text="Contained Value:" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,6,6" />
              <TextBox x:Name="ZoneBehaviorContainedBoxControl" Grid.Row="2" Grid.Column="1" MinWidth="160" Margin="0,0,0,6" Text="Contained" />

              <TextBlock Text="Partial Value:" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,6,0" />
              <TextBox x:Name="ZoneBehaviorPartialBoxControl" Grid.Row="3" Grid.Column="1" MinWidth="160" Text="Partial" />
            </Grid>
          </StackPanel>
          <CheckBox x:Name="EnableMultiZoneCheckControl" Content="Enable Multiple Zones" IsChecked="True" />
        </StackPanel>
      </Grid>
    </ui:Card>

    <ui:Card Grid.Row="2"
             Padding="10"
             Margin="0,0,0,8"
             HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch"
             VerticalContentAlignment="Top"
             VerticalAlignment="Top">
      <StackPanel>
        <ui:TextBlock Text="Zone Offsets" FontSize="14" FontWeight="SemiBold" />

        <UniformGrid Columns="2" Rows="3" Margin="0,8,0,0">
          <StackPanel Orientation="Horizontal" Margin="0,4">
            <StackPanel Orientation="Horizontal" Width="120" VerticalAlignment="Center">
              <TextBlock Text="3D Offset:" VerticalAlignment="Center" />
              <Button x:Name="Offset3DFlyoutButton"
                      Style="{StaticResource HelpFlyoutButtonStyle}">
                <ui:SymbolIcon Symbol="Info16" />
              </Button>
            </StackPanel>
            <ui:Flyout x:Name="Offset3DFlyout"
                       Placement="Top"
                       Opened="OnOffset3DFlyoutOpened"
                       Closed="OnOffset3DFlyoutClosed">
              <StackPanel x:Name="Offset3DFlyoutContent" Width="480">
                <TextBlock Text="3D Offset"
                           FontWeight="SemiBold"
                           TextAlignment="Center"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,4" />
                <TextBlock Text="Applies an overall 3D expansion to the zone volume before checking targets."
                           TextWrapping="Wrap"
                           Margin="0,0,0,6" />
                <Border CornerRadius="10"
                        BorderBrush="#FFFFFFFF"
                        BorderThickness="1"
                        Width="432"
                        Height="243"
                        ClipToBounds="True">
                  <MediaElement x:Name="Offset3DVideo"
                                LoadedBehavior="Manual"
                                UnloadedBehavior="Manual"
                                Stretch="Uniform"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Loaded="OnHelpVideoLoaded"
                                SizeChanged="OnHelpVideoSizeChanged"
                                IsMuted="True"
                                MediaOpened="OnHelpVideoOpened"
                                MediaEnded="OnHelpVideoEnded"
                                MediaFailed="OnHelpVideoFailed" />
                </Border>
              </StackPanel>
            </ui:Flyout>
            <TextBox x:Name="Offset3DBoxControl" Width="100" Text="0.0" Margin="6,0,0,0" />
          </StackPanel>

          <StackPanel Orientation="Horizontal" Margin="0,4">
            <StackPanel Orientation="Horizontal" Width="120" VerticalAlignment="Center">
              <TextBlock Text="Offset Sides:" VerticalAlignment="Center" />
              <Button x:Name="OffsetSidesFlyoutButton"
                      Style="{StaticResource HelpFlyoutButtonStyle}">
                <ui:SymbolIcon Symbol="Info16" />
              </Button>
            </StackPanel>
            <ui:Flyout x:Name="OffsetSidesFlyout"
                       Placement="Top"
                       Opened="OnOffsetSidesFlyoutOpened"
                       Closed="OnOffsetSidesFlyoutClosed">
              <StackPanel x:Name="OffsetSidesFlyoutContent" Width="480">
                <TextBlock Text="Offset Sides"
                           FontWeight="SemiBold"
                           TextAlignment="Center"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,4" />
                <TextBlock Text="Expands the zone horizontally on all sides before testing targets."
                           TextWrapping="Wrap"
                           Margin="0,0,0,6" />
                <Border CornerRadius="10"
                        BorderBrush="#FFFFFFFF"
                        BorderThickness="1"
                        Width="432"
                        Height="243"
                        ClipToBounds="True">
                  <MediaElement x:Name="OffsetSidesVideo"
                                LoadedBehavior="Manual"
                                UnloadedBehavior="Manual"
                                Stretch="Uniform"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Loaded="OnHelpVideoLoaded"
                                SizeChanged="OnHelpVideoSizeChanged"
                                IsMuted="True"
                                MediaOpened="OnHelpVideoOpened"
                                MediaEnded="OnHelpVideoEnded"
                                MediaFailed="OnHelpVideoFailed" />
                </Border>
              </StackPanel>
            </ui:Flyout>
            <TextBox x:Name="OffsetSidesBoxControl" Width="100" Text="0.0" Margin="6,0,0,0" />
          </StackPanel>

          <StackPanel Orientation="Horizontal" Margin="0,4">
            <StackPanel Orientation="Horizontal" Width="120" VerticalAlignment="Center">
              <TextBlock Text="Offset Bottom:" VerticalAlignment="Center" />
              <Button x:Name="OffsetBottomFlyoutButton"
                      Style="{StaticResource HelpFlyoutButtonStyle}">
                <ui:SymbolIcon Symbol="Info16" />
              </Button>
            </StackPanel>
            <ui:Flyout x:Name="OffsetBottomFlyout"
                       Placement="Top"
                       Opened="OnOffsetBottomFlyoutOpened"
                       Closed="OnOffsetBottomFlyoutClosed">
              <StackPanel x:Name="OffsetBottomFlyoutContent" Width="480">
                <TextBlock Text="Offset Bottom"
                           FontWeight="SemiBold"
                           TextAlignment="Center"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,4" />
                <TextBlock Text="Adds a vertical offset to the bottom of the zone before testing targets."
                           TextWrapping="Wrap"
                           Margin="0,0,0,6" />
                <Border CornerRadius="10"
                        BorderBrush="#FFFFFFFF"
                        BorderThickness="1"
                        Width="432"
                        Height="243"
                        ClipToBounds="True">
                  <MediaElement x:Name="OffsetBottomVideo"
                                LoadedBehavior="Manual"
                                UnloadedBehavior="Manual"
                                Stretch="Uniform"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Loaded="OnHelpVideoLoaded"
                                SizeChanged="OnHelpVideoSizeChanged"
                                IsMuted="True"
                                MediaOpened="OnHelpVideoOpened"
                                MediaEnded="OnHelpVideoEnded"
                                MediaFailed="OnHelpVideoFailed" />
                </Border>
              </StackPanel>
            </ui:Flyout>
            <TextBox x:Name="OffsetBottomBoxControl" Width="100" Text="0.0" Margin="6,0,0,0" />
          </StackPanel>

          <StackPanel Orientation="Horizontal" Margin="0,4">
            <StackPanel Orientation="Horizontal" Width="120" VerticalAlignment="Center">
              <TextBlock Text="Offset Top:" VerticalAlignment="Center" />
              <Button x:Name="OffsetTopFlyoutButton"
                      Style="{StaticResource HelpFlyoutButtonStyle}">
                <ui:SymbolIcon Symbol="Info16" />
              </Button>
            </StackPanel>
            <ui:Flyout x:Name="OffsetTopFlyout"
                       Placement="Top"
                       Opened="OnOffsetTopFlyoutOpened"
                       Closed="OnOffsetTopFlyoutClosed">
              <StackPanel x:Name="OffsetTopFlyoutContent" Width="480">
                <TextBlock Text="Offset Top"
                           FontWeight="SemiBold"
                           TextAlignment="Center"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,4" />
                <TextBlock Text="Adds a vertical offset to the top of the zone before testing targets."
                           TextWrapping="Wrap"
                           Margin="0,0,0,6" />
                <Border CornerRadius="10"
                        BorderBrush="#FFFFFFFF"
                        BorderThickness="1"
                        Width="432"
                        Height="243"
                        ClipToBounds="True">
                  <MediaElement x:Name="OffsetTopVideo"
                                LoadedBehavior="Manual"
                                UnloadedBehavior="Manual"
                                Stretch="Uniform"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Loaded="OnHelpVideoLoaded"
                                SizeChanged="OnHelpVideoSizeChanged"
                                IsMuted="True"
                                MediaOpened="OnHelpVideoOpened"
                                MediaEnded="OnHelpVideoEnded"
                                MediaFailed="OnHelpVideoFailed" />
                </Border>
              </StackPanel>
            </ui:Flyout>
            <TextBox x:Name="OffsetTopBoxControl" Width="100" Text="0.0" Margin="6,0,0,0" />
          </StackPanel>

          <StackPanel Orientation="Horizontal" Margin="0,4">
            <StackPanel Orientation="Horizontal" Width="120" VerticalAlignment="Center">
              <TextBlock Text="Units:" VerticalAlignment="Center" />
              <Button x:Name="UnitsFlyoutButton"
                      Style="{StaticResource HelpFlyoutButtonStyle}">
                <ui:SymbolIcon Symbol="Info16" />
              </Button>
            </StackPanel>
            <ui:Flyout x:Name="UnitsFlyout" Placement="Top">
              <StackPanel x:Name="UnitsFlyoutContent" Width="240">
                <TextBlock TextWrapping="Wrap"
                           Text="Units used for all offset inputs." />
              </StackPanel>
            </ui:Flyout>
            <TextBox x:Name="UnitsBoxControl" Width="140" Text="Millimeters" />
          </StackPanel>

          <StackPanel Orientation="Horizontal" Margin="0,4">
            <StackPanel Orientation="Horizontal" Width="120" VerticalAlignment="Center">
              <TextBlock Text="Offset Mode:" VerticalAlignment="Center" />
              <Button x:Name="OffsetModeFlyoutButton"
                      Style="{StaticResource HelpFlyoutButtonStyle}">
                <ui:SymbolIcon Symbol="Info16" />
              </Button>
            </StackPanel>
            <ui:Flyout x:Name="OffsetModeFlyout" Placement="Top">
              <StackPanel x:Name="OffsetModeFlyoutContent" Width="260">
                <TextBlock TextWrapping="Wrap"
                           Text="Defines how offsets are applied relative to the zone geometry." />
              </StackPanel>
            </ui:Flyout>
            <TextBox x:Name="OffsetModeBoxControl" Width="160" Text="From Zone Geometry" />
          </StackPanel>
        </UniformGrid>
      </StackPanel>
    </ui:Card>

    <ui:Card Grid.Row="3"
             Padding="10"
             Margin="0,8,0,0"
             HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch"
             VerticalContentAlignment="Top"
             VerticalAlignment="Top">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0">
          <ui:TextBlock Text="Estimate &amp; Performance" FontSize="14" FontWeight="SemiBold" />

          <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
            <TextBlock Text="Estimated runtime:" Width="160" />
            <TextBlock x:Name="EstimateRuntimeTextControl" Text="-" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
            <TextBlock Text="Zones / Targets:" Width="160" />
            <TextBlock x:Name="EstimateCountsTextControl" Text="-" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
            <TextBlock Text="Candidate pairs:" Width="160"
                       ToolTip="Number of zone-target AABB overlaps to evaluate." />
            <TextBlock x:Name="EstimatePairsTextControl" Text="-" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
            <TextBlock Text="Avg candidates/zone:" Width="160" />
            <TextBlock x:Name="EstimateAvgTextControl" Text="-" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
            <TextBlock Text="Confidence:" Width="160" />
            <TextBlock x:Name="EstimateConfidenceTextControl" Text="-" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
            <TextBlock Text="Cell size used:" Width="160" />
            <TextBlock x:Name="EstimateCellSizeTextControl" Text="-" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
            <TextBlock Text="Last preflight:" Width="160" />
            <TextBlock x:Name="EstimatePreflightTimeTextControl" Text="-" />
          </StackPanel>

          <StackPanel Margin="0,8,0,0">
            <TextBlock Text="Index Granularity" FontWeight="SemiBold" />
            <Slider x:Name="IndexGranularitySliderControl"
                    Minimum="0"
                    Maximum="4"
                    Value="0"
                    TickPlacement="Both"
                    Ticks="0,1,2,3,4"
                    IsSnapToTickEnabled="True"
                    SmallChange="1"
                    LargeChange="1"
                    Margin="0,6,0,0" />
            <Grid Margin="0,4,0,0">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <TextBlock Text="Auto" Grid.Column="0" HorizontalAlignment="Left" />
              <TextBlock Text="Coarse" Grid.Column="1" HorizontalAlignment="Center" />
              <TextBlock Text="Normal" Grid.Column="2" HorizontalAlignment="Center" />
              <TextBlock Text="Fine" Grid.Column="3" HorizontalAlignment="Center" />
              <TextBlock Text="Ultra" Grid.Column="4" HorizontalAlignment="Right" />
            </Grid>
            <TextBlock x:Name="IndexGranularityHintTextControl"
                       Margin="0,6,0,0"
                       Opacity="0.85"
                       TextWrapping="Wrap"
                       Text="Controls spatial grid cell size. Smaller cells reduce candidate pairs but increase index build cost." />
          </StackPanel>
        </StackPanel>

        <StackPanel Grid.Column="1" Margin="12,0,0,0">
          <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
            <TextBlock Text="Preflight:" Margin="0,0,6,0" />
            <TextBlock x:Name="PreflightStatusTextControl" Text="Idle" />
          </StackPanel>
          <ProgressBar x:Name="PreflightProgressBarControl"
                       Width="180"
                       Height="8"
                       Margin="0,6,0,0"
                       Minimum="0"
                       Maximum="100"
                       Value="0"
                       IsIndeterminate="False" />
          <ui:Button x:Name="RunPreflightButtonControl"
                     Content="Run Preflight"
                     Margin="0,8,0,0" />
          <CheckBox x:Name="LiveEstimateToggleControl"
                    Content="Live estimate"
                    Margin="0,6,0,0" />
          <CheckBox x:Name="ReusePreflightToggleControl"
                    Content="Reuse preflight for Run"
                    IsChecked="True"
                    Margin="0,4,0,0" />
        </StackPanel>
      </Grid>
    </ui:Card>

    <ui:Card Grid.Row="4"
             Padding="10"
             Margin="0,8,0,0"
             HorizontalAlignment="Stretch"
             HorizontalContentAlignment="Stretch"
             VerticalContentAlignment="Top"
             VerticalAlignment="Top">
      <Expander x:Name="AdvancedPerformanceExpanderControl"
                Header="Advanced Performance"
                IsExpanded="False">
        <StackPanel Margin="0,6,0,0">
          <StackPanel Orientation="Horizontal" Margin="0,4">
            <TextBlock Text="Max Threads:" Width="120" VerticalAlignment="Center" />
            <TextBox x:Name="MaxThreadsBoxControl" Width="80" Text="0" />
          </StackPanel>
          <StackPanel Orientation="Horizontal" Margin="0,4">
            <TextBlock Text="Batch Size:" Width="120" VerticalAlignment="Center" />
            <TextBox x:Name="BatchSizeBoxControl" Width="80" Text="0" />
          </StackPanel>
          <TextBlock Text="Use 0 to let Space Mapper choose automatically."
                     Margin="0,4,0,0"
                     Opacity="0.75"
                     TextWrapping="Wrap" />
        </StackPanel>
      </Expander>
    </ui:Card>
  </Grid>
</Page>
